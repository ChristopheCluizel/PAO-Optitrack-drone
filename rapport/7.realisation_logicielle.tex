\chapter{Réalisation logicielle}
\section{API de commande de l'ARDrone}
Étant un objet grand public, l'ARDrone bénéfice d'une communauté active. Cette communauté est à l'origine d'un certain nombre d'API de commande que ce soit en Javascript, C\#, Java ou C. Le SDK OptiTrack étant en C, nous avons recherché des API étant également codée en C afin de pouvoir fusionner facilement les deux outils.\\
Nos recherches nous ont menées au SDK de Parrot (la marque du drone), intégralement écrit en C et embarquant toutes les fonctionnalités nécessaires. Cependant, la phase de compilation de cette librairie s'est trouvée être très fastidieuse que ce soit sur Linux ou sur Windows. La raison est le nombre important de librairies tierces utilisé par le SDK du drone pour gérer les flux vidéo, les threads, ou encore les contrôleurs. Après avoir passé du temps a travaillé dessus et à tenter d'en extraire les fonctionnalités de pilotage du drone, il s'est avéré plus simple d'en écrire une nouvelle en C++, exclusivement dédiée au contrôle de l'appareil. De ce fait, nous perdons les informations fournies par le drone ( télémétrie, flux vidéo), mais gagnons en simplicité et comprenons mieux ce que nous faisons.
\subsection{API réalisée}
Le drone se contrôle assez simplement, mais selon un formalisme strict. Pour interagir avec, il faut se connecter en UDP sur le port 5556 de l'appareil (192.168.1.1). Une fois connecté, il faut envoyer des commandes \textbf{AT} au minimum toute les 50 ms pour maintenir la connexion active. Les commandes diffèrent selon la nature de l'instruction.
\begin{itemize}
\item \textit{AT*FTRIM=seq} pour calibrer le drone, avec \textit{seq} le numéro du message ;
\item \textit{AT*COMWDG=seq} pour maintenir la connexion sans donner d'instruction ;
\item \textit{AT*REF=seq,value} pour faire décoller/atterrir ou stopper le drone en urgence ;
\item ...
\end{itemize}
L'API réalisé propose donc un objet ARDrone contrôlant un thread de communication avec le drone et plusieurs méthode simple comme \textit{takeOff()}, \textit{move()} ou \textit{land()}.
\section{Récupération des données 3D}